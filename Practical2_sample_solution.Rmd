
```{r 'check_ps', include=FALSE}

user.name = 'Jane Doe'
```


<img src=https://images.unsplash.com/photo-1593594820228-a05cc04bc433?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80  width=400 height=200 style="float:right">

## Exercise 2 -- Duck nest analysis

This has been your first experience using the `Distance` package.  There are only a handful of functions you need to successfully complete a distance sampling analysis.  This practical gave you experience with these functions.  The data are familiar to you because they the same data you used when trying to fit a detection function by hand in Exercise 1.  This exercise lets the computer do the work.  Compare the estimate of duck nest density produced by `Distance` with the estimate you manually produced.

You should have already executed code as described in Practical 2.  I have duplicated some of the code and output here to reduce your need to switch between this tutorial and your previous work.

info("preknit_PTePlYLUtULI")



Quiz: For the half normal detection function, what was the estimated value of $\hat{P}_a$?

- 0.869 [x]

- 0.039 [ ]

- 614.25 [ ]

- 0.933 [ ]



Quiz: Now that you have an estimate of $\hat{P}_a$, what does it mean?

- distance to which nests were detected [ ]

- area under the curve [ ]

- proportion of nests detected out to 2.4m [x]

- number of iterations needed to estimate detection function parameters [ ]


### Density estimate to abundance estimate

a) The field `area` was set to 0 in the `ducknest` data frame; however the practical description notes that the refuge is 47.7 km^2 in size.  Use the code block below to compute the number of duck nests on the refuge based upon your estimate of $\hat{D}$.

```{r "1_a"}
dhat <- 49.69
area <- 47.7
est.num.nests <- dhat * area
print(est.num.nests)
```


### Assessing model fit

b) Although we have not yet discussed how to assess fit of our models to data, Practical 2 did introduce you to the function `gof_ds`.  In the code chunk below, apply this goodness of fit function to the half normal detection function fitted to the duck nest data and interpret the results.

info("preknit_PNSvwqxqKRks")


Quiz: How should the plot be interpreted? (select two correct answers)

- departures from good fit are indicated by departures from the underlying 45° line [x]

- model that fits has all points near the 45° line [x]

- this plot has nothing to do with model fit [ ]

- a rapid rise in the graphed points implies good model fit [ ]



Quiz: The numerical output from `gof_ds` is from the Cramer-von Mises test.   Interpret the output.

- P-value is <1, therefore the model fit is poor [ ]

- The test statistic is smaller than the P-value, therefore the fit is adequate [ ]

- The test statistic is close to 0, therefore the fit is poor [ ]

- P-value is close to one, indicating that there’s no reason to suspect the fit is inadequate [x]


### Difference in density estimates from different models

info("preknit_rIYyIJJdRFVJ")

c) The preceding code fit all three key function models to the duck nest data.  To reinforce the idea that similar results are produced *(for good data)* from the different key functions, write a few lines of code to explore this.  Value entered to one decimal place.
- find key function model that produces the lowest density estimate and assign to `nest.hr.herm`
- find the key function model that produces the largest density estimate and assign to `nest.uf.cos`
- compute the difference between these estimates (`d.diff`) and
- relativise by dividing by the smaller density estimate `rel.diff`

```{r "1_c"}
nest.hr.herm <- 48.6
nest.uf.cos <- 51.0
d.diff <- nest.uf.cos - nest.hr.herm
rel.diff <- d.diff / nest.hr.herm
print(rel.diff)
```


Quiz: To the nearest **percent**, what is the relative difference between the largest and smallest density estimate you just computed?

Answer: 5
